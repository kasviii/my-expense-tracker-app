{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4 text-success">Add New Category</h2>

    <form method="POST" action="{{ url_for('add_category_page') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        
        <div class="mb-3">
            <label for="name" class="form-label">Category Name<span class="text-danger">*</span></label>
            <input type="text" class="form-control" id="name" name="name" placeholder="Enter category name" required>
        </div>

        <div class="mb-3">
            <label for="description" class="form-label">Description</label>
            <input type="text" class="form-control" id="description" name="description" placeholder="Optional description">
        </div>

        <div class="mb-4">
            <label for="budget" class="form-label">Budget Limit</label>
            <input type="number" class="form-control" id="budget" name="budget" step="0.01" placeholder="Optional budget limit (e.g. 5000)">
        </div>

        <button type="submit" class="btn btn-success">Add Category</button>
        <a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary ms-2">Cancel</a>
    </form>

    {% if categories %}
    <h3 class="mt-5">Your Categories</h3>
    <table class="table table-bordered mt-3 bg-white">
        <thead>
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Budget</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for cat in categories %}
            <tr>
                <td>{{ cat.name }}</td>
                <td>{{ cat.description or '-' }}</td>
                <td>{{ cat.budget or '-' }}</td>
                <td>
                    <a href="{{ url_for('edit_category_page', id=cat.id) }}" class="btn btn-sm btn-outline-primary">Edit</a>

                    <form method="POST" action="{{ url_for('delete_category_form', id=cat.id) }}"
                          style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this category?');">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p class="mt-4 text-muted">No categories added yet.</p>
    {% endif %}
</div>
{% endblock %}